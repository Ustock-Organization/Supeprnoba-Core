# 수동 주문 입력 (Manual Order Entry) -- Liquibook 예제 프로그램

이 프로그램은 콘솔에서 입력하거나 스크립트 파일에서 읽은 요청을 받아 하나 이상의 오더북(order book)에 적용합니다. 그리고 해당 요청에 대한 응답으로 Liquibook이 생성한 콜백 결과를 표시합니다.

## 명령줄 (The Command Line)

mt_order_entry 명령은 두 가지 명령줄 옵션을 허용합니다. 둘 다 선택 사항입니다.

매개변수:

* script_file_name
  스크립트 파일의 이름입니다.
  * 스크립트 파일은 일련의 요청을 포함하며, 한 줄에 하나씩 작성됩니다. 요청 구문은 아래를 참조하십시오.
  * 스크립트 파일을 원하지 않지만 로그 파일을 지정하고 싶은 경우, 스크립트 파일 이름에 하이픈(-) 하나를 사용하십시오. 명령은 콘솔에서 읽혀집니다.
* log_file_name
  출력이 기록될 파일의 이름입니다.
  * 프롬프트(있는 경우)는 여전히 콘솔에 기록됩니다.

## 요청 구문 (Request syntax)
요청은 콘솔이나 스크립트 파일에서 읽습니다.

빈 줄이나 해시(#)로 시작하는 줄은 주석으로 간주되어 무시됩니다.
읽어들인 다른 줄은 다음 형식을 따릅니다:

   REQUEST [parameters]* [;]

즉, 한 단어의 요청 뒤에 필요한 매개변수가 오고 세미콜론으로 끝납니다.

일부 명령의 경우 세미콜론은 선택 사항일 수 있지만, 원한다면 항상 포함할 수 있습니다.
독립된 단어 "END"를 세미콜론 대신 사용할 수 있습니다.

요청이 선택적 매개변수를 허용하거나 필수 매개변수가 모두 제공되지 않은 경우, 세미콜론이 입력될 때까지 콘솔 사용자에게 추가 매개변수를 묻는 프롬프트가 표시됩니다.
이 프롬프트는 입력이 파일에서 읽혀지는 경우에도 발생하므로, 스크립트 파일에서 들어오는 요청은 완전해야 하며 세미콜론으로 끝나야 합니다.

#### 예시:
<pre>
   > BUY 100 GOOG 850 AON;
       ADDING order:  [#2 BUY 100 GOOG $850 AON Last Event:{Submitted BUY 100 GOOG @850}]
   > BUY              (불완전한 요청)
   Quantity: 100      (매개변수 프롬프트)
   Symbol: GOOG
   Limit Price or MKT: 800
   AON, or IOC, or STOP, or END: ;
       ADDING order:  [#3 BUY 100 GOOG $800 Last Event:{Submitted BUY 100 GOOG @800}]
</pre>
## 요청 (Requests)

대부분의 요청은 전체 철자를 쓰거나 첫 글자로 약어화할 수 있습니다.
각 요청이 허용하는 매개변수는 이 문서의 뒷부분에서 설명합니다.
요청은 대소문자를 구분하지 않습니다. 여기서는 모두 대문자로 표시되지만, BUY 요청은 BUY, buy, b, 또는 Buy로 입력될 수 있습니다.
<pre>
* BUY 또는 B      : 증권을 매수하기 위한 새 주문을 입력합니다.
* SELL 또는 S     : 증권을 매도하기 위한 새 주문을 입력합니다.
* CANCEL 또는 C   : 기존 주문 취소를 요청합니다.
* MODIFY 또는 M   : 기존 주문 수정을 요청합니다.
* DISPLAY 또는 D  : 기존 주문에 대한 정보를 표시합니다.
* FILE 또는 F     : 스크립트 파일을 열거나 닫습니다.
* ?             : 요청에 대한 도움말을 표시합니다.
* QUIT          : 프로그램을 종료합니다.
</pre>

## 심볼 (Symbols)

Liquibook 자체는 심볼에 제한을 두지 않습니다. 임의의 문자열을 허용합니다.
(실제로는 8비트 옥텟이므로 특별한 노력 없이 UTF-8 또는 기타 인코딩이 지원됩니다.)

수동 입력 프로그램은 파싱을 쉽게 하기 위해 심볼에 몇 가지 제한을 둡니다:

    * 심볼에 공백을 포함할 수 없습니다.
    * 심볼은 더하기 기호(+)나 느낌표(!)로 시작할 수 없습니다.
    * 심볼은 ALL이 아니어야 합니다.
    * 심볼은 단일 별표(*)가 아니어야 합니다.

이러한 제한은 Liquibook 자체가 아니라 예제 프로그램에만 적용된다는 점을 강조하는 것이 중요합니다.

공백을 허용하지 않으면 들어오는 요청을 파싱하기가 분명히 더 쉬워집니다.
"ALL"과 "*"를 사용하면 DISPLAY 명령 파싱과 충돌할 수 있습니다.

선행 더하기 기호와 느낌표에 대한 제한은 추가 설명이 필요합니다.

Liquibook은 각 증권에 대해 별도의 오더북을 사용합니다. 새로운 심볼이 발견되면(새로운 증권을 나타냄) 수동 입력 프로그램은 해당 심볼에 대한 새 오더북을 생성합니다. 이때 단순 오더북을 생성할지 뎁스 북(depth book)을 생성할지 알아야 합니다.

* 새 심볼 앞에 더하기 기호(+)가 있으면 단순 오더북이 생성됩니다.
* 느낌표(!)가 앞에 있으면 뎁스 북이 생성됩니다.
* 이러한 접두사가 없으면 수동 입력 프로그램은 콘솔 사용자에게 어떤 유형의 북을 생성할지 묻습니다.

예시:
<pre>
    > buy 100 ibm 50;
    New Symbol IBM.
    Add [S]imple book, or [D]epth book, or 'N' to cancel request.
    [SDN}: d
    Create new depth order book for IBM
    ADDING order:  [#1 BUY 100 IBM $50 Last Event:{Submitted BUY 100 IBM @50}]
            Accepted: [#1 BUY 100 IBM $50 Open: 100 Last Event:{Accepted }]
            Book Change:  IBM
            Depth Change:  IBM Changed Change Id: 1 Published: 0
            BIDS:
            Price 50 Count: 1 Quantity: 100 Change id#: 1
            BBO Change:  IBM Changed Change Id: 1 Published: 0
    > buy 200 t 78;
    New Symbol T.
    Add [S]imple book, or [D]epth book, or 'N' to cancel request.
    [SDN}: s
    Create new order book for T
    ADDING order:  [#2 BUY 200 T $78 Last Event:{Submitted BUY 200 T @78}]
            Accepted: [#2 BUY 200 T $78 Open: 200 Last Event:{Accepted }]
            Book Change:  T
    > buy 50 r 99;
    New Symbol R.
    Add [S]imple book, or [D]epth book, or 'N' to cancel request.
    [SDN}: n
    Request ignored
    Cannot process command BUY 50 R 99 ;
</pre>

콘솔 프롬프트는 스크립팅과 잘 어울리지 않으므로, 스크립트에서 사용되는 심볼은 처음 나타날 때 적절한 접두사를 갖는 것이 중요합니다.

이미 북이 존재하는 심볼에 + 또는 ! 접두사를 붙이는 것은 허용됩니다. 접두사는 무시되고 기존 북이 사용됩니다.

## 가격 (Prices)

Liquibook은 가격에 정수를 사용합니다. 특정 증권에 대한 모든 주문이 동일한 단위를 사용하는 한 실제로 어떤 통화 단위가 사용되는지는 신경 쓰지 않습니다.

Liquibook은 정수를 사용하므로 가격은 "원자 통화 단위(atomic currency unit)"로 표현되어야 합니다. 예를 들어 가격이 미국 달러인 경우 원자 통화 단위는 종종 페니이므로, 15달러는 Liquibook에 1500으로 표현됩니다.

가격이 필요한 대부분의 경우, MARKET(또는 약어 MKT)이라는 단어가 허용되며, 이는 이 주문에 대해 지정가(limit price)가 지정되지 않았음을 나타냅니다. 거래는 상대 주문에 지정된 가격으로 생성되거나, 거래의 양쪽이 모두 MARKET 가격을 지정한 경우 증권의 현재 시장 가격으로 생성될 수 있습니다.

## 주문 식별 (Order Identity)

Liquibook은 애플리케이션 주문 객체의 메모리 주소를 주문 식별자로 사용합니다. [이는 객체 수명에 이상한 제한을 부과하므로 향후 변경될 수 있습니다.] 수동 입력 프로그램은 콘솔 사용자(또는 스크립트)가 주문을 식별할 방법이 필요하며, 메모리 주소는 분명히 이 목적으로 사용할 수 없습니다.

따라서 주문 입력 프로그램은 각 주문에 주문 ID를 할당합니다. 주문이 표시될 때마다 주문 ID가 해시 기호(#) 뒤에 나타납니다.
예를 들어 새 주문이 추가되고 응답이 다음과 같다면:

      ADDING order:  [#1 BUY 100 IBM $50 Last Event:{Submitted BUY 100 IBM @50}]

이 주문은 다음 명령에서 주문 ID 1을 사용하여 참조할 수 있습니다. 콘솔이나 스크립트에서 주문을 읽을 때 선택적으로 #을 주문 ID 앞에 붙일 수 있습니다. 따라서 "Cancel #1"과 "CANCEL 1"은 동일한 주문을 참조합니다.

주문 ID는 선행 마이너스 기호와 함께 입력될 수도 있습니다. 이러한 주문 ID는 다음에 사용될 주문 ID에 상대적입니다.
따라서 "Cancel -1"은 가장 최근에 입력된 주문을 취소합니다. "Cancel -2"는 그 전 주문을 취소하는 식입니다.

## 특정 요청의 세부 사항 (Details of specific Requests)

### BUY 또는 B
증권을 매수하기 위한 새 주문을 입력합니다.

구문:  BUY quantity symbol price [AON | IOC | STOP price]* ;

매개변수:
* *quantity*는 매수할 주식(또는 기타 거래 가능 단위)의 수입니다.
* *symbol*은 임의의 문자열입니다.
  * 이 문자열에 대한 정보는 위의 **심볼** 섹션을 참조하십시오.
* *price*는 트레이더가 증권의 각 거래 가능 단위에 대해 지불할 의사가 있는 최고 가격, 또는 모든 거래를 수락하려면 MARKET입니다.
  * 가격 표현에 대한 자세한 내용은 위의 **가격** 섹션을 참조하십시오.
* AON  이 선택적 매개변수는 이 주문에 대한 All-Or-None 조건을 설정합니다.
* IOC  이 선택적 매개변수는 이 주문에 대한 Immediate-Or-Cancel 조건을 설정합니다.
* STOP price  이 선택적 매개변수는 가격 매개변수와 동일한 통화 단위를 사용하여 이 주문에 대한 STOP LOSS 가격을 설정합니다.

BUY 요청에는 후행 세미콜론(또는 단어 END)이 필요합니다.

BUY 주문을 입력하면 0개 이상의 거래가 트리거될 수 있습니다.

### SELL 또는 S
증권을 매도하기 위한 새 주문을 입력합니다.

구문:  SELL quantity symbol price [AON | IOC | STOP price]* ;

매개변수:
* *quantity*는 매도할 주식(또는 기타 거래 가능 단위)의 수입니다.
* *symbol*은 임의의 문자열입니다.
  * 이 문자열에 대한 정보는 위의 **심볼** 섹션을 참조하십시오.
* *price*는 트레이더가 증권의 각 거래 가능 단위에 대해 수락할 의사가 있는 최저 가격, 또는 모든 거래를 수락하려면 MARKET입니다.
  * 가격 표현에 대한 자세한 내용은 위의 **가격** 섹션을 참조하십시오.
* AON  이 선택적 매개변수는 이 주문에 대한 All-Or-None 조건을 설정합니다.
* IOC  이 선택적 매개변수는 이 주문에 대한 Immediate-Or-Cancel 조건을 설정합니다.
* STOP price  이 선택적 매개변수는 가격 매개변수와 동일한 통화 단위를 사용하여 이 주문에 대한 STOP LOSS 가격을 설정합니다.

SELL 요청에는 후행 세미콜론(또는 단어 END)이 필요합니다.

SELL 주문을 입력하면 0개 이상의 거래가 트리거될 수 있습니다.

### CANCEL 또는 C
기존 주문 취소를 요청합니다.

매개변수:
* orderid, 또는 #orderid, 또는 -relative_order_id.
  * 자세한 내용은 위의 **주문 식별** 섹션을 참조하십시오.

CANCEL 요청을 입력해도 거래는 트리거되지 않습니다.

CANCEL 요청의 경우 후행 세미콜론(또는 단어 END)은 선택 사항입니다. 하나의 필수 매개변수 후에 요청이 완료된 것으로 간주됩니다.

주문이 이미 체결된 경우 요청이 거부될 수 있습니다.

### MODIFY 또는 M

기존 주문 수정을 요청합니다.

매개변수:
* orderid, 또는 #orderid, 또는 -relative_order_id.
  * 자세한 내용은 위의 **주문 식별** 섹션을 참조하십시오.
* PRICE new_price
  * 가격 표현에 대한 자세한 내용은 위의 **가격** 섹션을 참조하십시오.
  * 가격은 인상되거나 인하될 수 있습니다.
  * PRICE는 선택 사항입니다. 지정하지 않으면 기존 가격이 변경되지 않습니다.
* QUANTITY new_initial_quantity
  * 참고: 이것은 오픈될 새로운 수량이 아닙니다(그것은 유동적인 목표입니다). 또한 수량에 대한 델타도 아닙니다(Liquibook이 내부적으로 표현하는 방식이긴 하지만).
  * QUANTITY는 선택 사항입니다. 지정하지 않으면 기존 수량이 변경되지 않습니다.

MODIFY 요청에는 후행 세미콜론(또는 단어 END)이 필요합니다.

MODIFY 요청을 입력하면 0개 이상의 거래가 트리거될 수 있습니다.

주문이 이미 체결되었거나 변경 요청이 없는 경우 요청이 거부될 수 있습니다.

### DISPLAY 또는 D
기존 주문에 대한 정보를 표시합니다.

매개변수:
* * 이 선택적 첫 번째 매개변수(단일 별표(*))는 더 자세한 표시를 요청합니다.
* order_id 또는 symbol 또는 ALL.
  * 이 중 하나가 나타나야 합니다.
  * 주문 ID를 표현하는 방법에 대한 설명은 위의 **주문 식별** 섹션을 참조하십시오.
  * 심볼은 특정 심볼과 관련된 모든 주문을 표시합니다.
  * 리터럴 단어 ALL은 알려진 모든 심볼에 대한 정보를 표시합니다.

### FILE 또는 F
스크립트 파일을 열거나 닫습니다.

매개변수:
* 이 명령이 스크립트 파일에 나타나면 매개변수가 허용되지 않습니다. 이는 스크립트 파일을 닫으라는 요청으로 간주됩니다.
* filename    이 명령이 콘솔에서 입력된 경우, 파일 이름은 향후 명령을 가져올 스크립트 파일의 이름입니다.

다음과 같은 경우까지 스크립트 파일에서 명령을 읽습니다:
* 스크립트 파일에 "FILE" 명령이 나타날 때
* 스크립트 파일의 끝(End-of-file)
* 스크립트 파일에 "QUIT" 명령이 나타날 때

스크립트 파일이 원래 콘솔에서 입력된 FILE 명령에 의해 열렸고, FILE 명령이나 파일 끝으로 인해 스크립트가 종료되면 제어권이 콘솔로 반환됩니다.
스크립트 파일이 명령줄에서 열렸거나( **명령줄** 섹션 참조), 스크립트 파일에 QUIT 명령이 나타나면 프로그램이 종료됩니다.

### HELP 또는 ?
요청에 대한 도움말을 표시합니다.

이 문서 정보의 요약된 형태를 표시합니다.

### QUIT
프로그램을 종료합니다.
